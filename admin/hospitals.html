<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Hospitals - MedLocator</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../css/admin.css">
</head>
<body>
    <header class="admin-header">
        <div class="container">
            <div class="logo">
                <h1>MedLocator Admin</h1>
            </div>
            <nav class="admin-nav">
                <ul>
                    <li><a href="index.html">Dashboard</a></li>
                    <li><a href="hospitals.html" class="active">Hospitals</a></li>
                    <li><a href="diseases.html">Diseases</a></li>
                    <li><a href="#" id="logout-btn">Logout</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="admin-main container">
        <h2>Manage Hospitals</h2>
        
        <div class="form-container">
            <h3>Add/Edit Hospital</h3>
            <form id="hospital-form">
                <input type="hidden" id="hospital-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="hospital-name">Hospital Name</label>
                        <input type="text" id="hospital-name" required>
                    </div>
                    <div class="form-group">
                        <label for="hospital-address">Address</label>
                        <input type="text" id="hospital-address" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="hospital-phone">Phone</label>
                        <input type="tel" id="hospital-phone" required>
                    </div>
                    <div class="form-group">
                        <label for="hospital-email">Email</label>
                        <input type="email" id="hospital-email" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="hospital-website">Website</label>
                        <input type="url" id="hospital-website">
                    </div>
                    <div class="form-group">
                        <label for="hospital-rating">Rating (1-5)</label>
                        <input type="number" id="hospital-rating" min="1" max="5" step="0.1" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="hospital-distance">Distance (km)</label>
                        <input type="text" id="hospital-distance" required>
                    </div>
                    <div class="form-group">
                        <label for="hospital-image">Image URL</label>
                        <input type="text" id="hospital-image" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="hospital-specialties">Specialties (comma separated)</label>
                    <input type="text" id="hospital-specialties" required>
                </div>
                
                <div class="form-group">
                    <label for="hospital-description">Description</label>
                    <textarea id="hospital-description" rows="4" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="hospital-hours">Operating Hours</label>
                    <textarea id="hospital-hours" rows="2" required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="hospital-latitude">Latitude</label>
                        <input type="number" id="hospital-latitude" step="any" required>
                    </div>
                    <div class="form-group">
                        <label for="hospital-longitude">Longitude</label>
                        <input type="number" id="hospital-longitude" step="any" required>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn secondary" id="cancel-btn">Cancel</button>
                    <button type="submit" class="btn primary">Save Hospital</button>
                </div>
            </form>
        </div>
        
        <h3>All Hospitals</h3>
        <table class="admin-table" id="hospitals-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Address</th>
                    <th>Specialties</th>
                    <th>Rating</th>
                    <th>Distance</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Hospitals will be loaded here by JavaScript -->
            </tbody>
        </table>
    </main>

    <script>
        // Sample data for hospitals (same as in your main app)
        const hospitals = [
            {
                id: 1,
                name: "Metro Manila General Hospital",
                address: "123 Health Avenue, Quezon City, Metro Manila",
                phone: "+63 2 123 4567",
                email: "info@mmgh.com",
                website: "www.mmgh.com",
                description: "A leading general hospital in Metro Manila with specialized departments for various conditions.",
                specialties: ["diabetes", "heart disease", "cancer", "asthma"],
                rating: 4.5,
                distance: "2.5 km",
                image: "images/hospital1.jpg",
                hours: "Monday-Friday: 8:00 AM - 5:00 PM\nEmergency: 24/7",
                latitude: 14.6762,
                longitude: 121.0439
            },
            {
                id: 2,
                name: "Cebu City Medical Center",
                address: "456 Wellness Street, Cebu City, Cebu",
                phone: "+63 32 234 5678",
                email: "contact@cebumed.com",
                website: "www.cebumed.com",
                description: "Modern medical facility in Cebu specializing in chronic disease management.",
                specialties: ["diabetes", "kidney disease", "arthritis"],
                rating: 4.2,
                distance: "5.1 km",
                image: "images/hospital2.jpg",
                hours: "Monday-Saturday: 7:00 AM - 7:00 PM\nEmergency: 24/7",
                latitude: 10.3157,
                longitude: 123.8854
            },
            {
                id: 3,
                name: "Davao Regional Hospital",
                address: "789 Care Boulevard, Davao City, Davao del Sur",
                phone: "+63 82 345 6789",
                email: "support@davaoregional.com",
                website: "www.davaoregional.com",
                description: "Comprehensive healthcare services with focus on rare diseases and specialized treatments.",
                specialties: ["cancer", "rare diseases", "heart disease"],
                rating: 4.7,
                distance: "1.8 km",
                image: "images/hospital3.jpg",
                hours: "Monday-Friday: 7:30 AM - 4:30 PM\nEmergency: 24/7",
                latitude: 7.1907,
                longitude: 125.4553
            },
            {
                id: 4,
                name: "Baguio Health Institute",
                address: "101 Mountain View Road, Baguio City, Benguet",
                phone: "+63 74 456 7890",
                email: "info@baguiohealth.com",
                website: "www.baguiohealth.com",
                description: "Specialized hospital in the cool climate of Baguio, ideal for respiratory conditions.",
                specialties: ["asthma", "allergies", "respiratory diseases"],
                rating: 4.3,
                distance: "8.3 km",
                image: "images/hospital4.jpg",
                hours: "Monday-Sunday: 8:00 AM - 6:00 PM\nEmergency: 24/7",
                latitude: 16.4023,
                longitude: 120.5960
            }
        ];

        // DOM Elements
        const hospitalsTable = document.getElementById('hospitals-table');
        const hospitalForm = document.getElementById('hospital-form');
        const cancelBtn = document.getElementById('cancel-btn');
        const logoutBtn = document.getElementById('logout-btn');

        // Current editing state
        let editingHospitalId = null;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadHospitalsTable();
            
            // Set up form submission
            hospitalForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveHospital();
            });
            
            // Set up cancel button
            cancelBtn.addEventListener('click', resetForm);
            
            // Set up logout button
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // In a real app, you would clear the session/token
                    alert('Logged out successfully');
                    window.location.href = '../login.html';
                });
            }
        });

        // Load hospitals into the table
        function loadHospitalsTable() {
            const tbody = hospitalsTable.querySelector('tbody');
            tbody.innerHTML = '';
            
            hospitals.forEach(hospital => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${hospital.id}</td>
                    <td>${hospital.name}</td>
                    <td>${hospital.address}</td>
                    <td>${hospital.specialties.join(', ')}</td>
                    <td>${hospital.rating}</td>
                    <td>${hospital.distance}</td>
                    <td class="table-actions">
                        <button class="btn edit" data-id="${hospital.id}"><i class="fas fa-edit"></i> Edit</button>
                        <button class="btn delete" data-id="${hospital.id}"><i class="fas fa-trash"></i> Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.btn.edit').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editHospital(id);
                });
            });
            
            document.querySelectorAll('.btn.delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    if (confirm('Are you sure you want to delete this hospital?')) {
                        deleteHospital(id);
                    }
                });
            });
        }

        // Edit hospital
        function editHospital(id) {
            const hospital = hospitals.find(h => h.id === id);
            if (!hospital) return;
            
            editingHospitalId = id;
            
            // Fill the form with hospital data
            document.getElementById('hospital-id').value = hospital.id;
            document.getElementById('hospital-name').value = hospital.name;
            document.getElementById('hospital-address').value = hospital.address;
            document.getElementById('hospital-phone').value = hospital.phone;
            document.getElementById('hospital-email').value = hospital.email;
            document.getElementById('hospital-website').value = hospital.website;
            document.getElementById('hospital-rating').value = hospital.rating;
            document.getElementById('hospital-distance').value = hospital.distance;
            document.getElementById('hospital-image').value = hospital.image;
            document.getElementById('hospital-specialties').value = hospital.specialties.join(', ');
            document.getElementById('hospital-description').value = hospital.description;
            document.getElementById('hospital-hours').value = hospital.hours;
            document.getElementById('hospital-latitude').value = hospital.latitude;
            document.getElementById('hospital-longitude').value = hospital.longitude;
            
            // Scroll to form
            document.querySelector('.form-container').scrollIntoView({ behavior: 'smooth' });
        }

        // Save hospital (add or update)
        function saveHospital() {
            const idInput = document.getElementById('hospital-id');
            const id = idInput.value ? parseInt(idInput.value) : null;
            
            const hospitalData = {
                name: document.getElementById('hospital-name').value,
                address: document.getElementById('hospital-address').value,
                phone: document.getElementById('hospital-phone').value,
                email: document.getElementById('hospital-email').value,
                website: document.getElementById('hospital-website').value,
                rating: parseFloat(document.getElementById('hospital-rating').value),
                distance: document.getElementById('hospital-distance').value,
                image: document.getElementById('hospital-image').value,
                specialties: document.getElementById('hospital-specialties').value.split(',').map(s => s.trim()),
                description: document.getElementById('hospital-description').value,
                hours: document.getElementById('hospital-hours').value,
                latitude: parseFloat(document.getElementById('hospital-latitude').value),
                longitude: parseFloat(document.getElementById('hospital-longitude').value)
            };
            
            if (id) {
                // Update existing hospital
                const index = hospitals.findIndex(h => h.id === id);
                if (index !== -1) {
                    hospitals[index] = { ...hospitals[index], ...hospitalData };
                }
            } else {
                // Add new hospital
                const newId = hospitals.length > 0 ? Math.max(...hospitals.map(h => h.id)) + 1 : 1;
                hospitals.push({ id: newId, ...hospitalData });
            }
            
            // Reload table and reset form
            loadHospitalsTable();
            resetForm();
            
            alert('Hospital saved successfully!');
        }

        // Delete hospital
        function deleteHospital(id) {
            const index = hospitals.findIndex(h => h.id === id);
            if (index !== -1) {
                hospitals.splice(index, 1);
                loadHospitalsTable();
                alert('Hospital deleted successfully!');
            }
        }

        // Reset the form
        function resetForm() {
            hospitalForm.reset();
            document.getElementById('hospital-id').value = '';
            editingHospitalId = null;
        }
    </script>
</body>
</html>